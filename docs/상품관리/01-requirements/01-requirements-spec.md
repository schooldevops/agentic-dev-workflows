# 업무요건 정의서: 상품관리

**프로젝트명**: 차세대 플랫폼 - 상품관리  
**요청 부서**: 이커머스 사업팀  
**작성일**: 2026-02-06  
**작성자**: 기획 Agent  
**버전**: v1.0

---

## 1. 업무요건 정의서

| ID | 대분류 | 중분류 | 요건 명칭 | 상세 요구사항 | 비즈니스 규칙 및 제약사항 | 우선순위 |
|---|---|---|---|---|---|---|
| **FR-001** | 상품관리 | 상품등록 | 신규 상품 등록 | **입력**: 상품명, 카테고리, 가격, 재고수량, 상품설명, 이미지(최대 10장)<br>**처리**: 상품코드 자동 생성(PRD-YYYYMMDD-NNNN), 등록일시 자동 기록, 초기 상태는 '임시저장'<br>**출력**: 생성된 상품코드, 등록 성공 메시지 | - 상품명: 2자 이상 100자 이하, 특수문자 제한(!, @, # 허용)<br>- 가격: 0원 이상, 100원 단위 절사<br>- 재고: 0 이상 정수<br>- 이미지: JPG/PNG, 각 5MB 이하<br>- 중복 상품명 허용(카테고리 다를 경우) | **P0** |
| **FR-002** | 상품관리 | 상품수정 | 기존 상품 정보 수정 | **입력**: 상품코드, 수정할 필드(상품명, 가격, 재고, 설명, 이미지)<br>**처리**: 수정 이력 자동 기록(수정자, 수정일시, 변경 전/후 값), 버전 증가<br>**출력**: 수정 완료 메시지, 변경 이력 ID | - '판매중' 상태 상품의 가격 변경 시 10% 이상 변동 불가<br>- 재고 감소는 현재 재고 이하로만 가능<br>- 이미지 수정 시 기존 이미지는 삭제되지 않고 보관(최대 30일)<br>- 수정 권한: 상품 등록자 또는 관리자 | **P0** |
| **FR-003** | 상품관리 | 상품삭제 | 상품 논리 삭제 | **입력**: 상품코드, 삭제 사유<br>**처리**: 상태를 '삭제됨'으로 변경, 물리적 삭제 안 함, 삭제 이력 기록<br>**출력**: 삭제 완료 메시지 | - '판매중' 상태 상품은 즉시 삭제 불가, 먼저 '판매중지'로 변경 필요<br>- 주문 이력이 있는 상품은 삭제 불가, '판매종료'로만 변경 가능<br>- 삭제된 상품은 30일 후 물리적 삭제 예약<br>- 삭제 권한: 관리자만 가능 | **P1** |
| **FR-004** | 상품관리 | 상품조회 | 상품 목록 조회 | **입력**: 검색 조건(상품명, 카테고리, 가격범위, 상태, 등록일 범위), 정렬 기준, 페이지 번호, 페이지 크기<br>**처리**: 조건에 맞는 상품 목록 조회, 페이징 처리(기본 20건)<br>**출력**: 상품 목록(상품코드, 상품명, 가격, 재고, 상태, 등록일), 총 건수, 페이지 정보 | - 검색 결과는 최대 1,000건까지 조회<br>- 기본 정렬: 등록일 내림차순<br>- 응답 시간: 500ms 이하<br>- '삭제됨' 상태 상품은 관리자만 조회 가능 | **P0** |
| **FR-005** | 상품관리 | 상품상세조회 | 단일 상품 상세 정보 조회 | **입력**: 상품코드<br>**처리**: 상품 상세 정보 조회, 조회수 증가<br>**출력**: 상품 전체 정보(기본 정보, 이미지, 설명, 재고, 수정 이력) | - 존재하지 않는 상품코드 입력 시 404 에러<br>- '삭제됨' 상태 상품은 관리자만 조회 가능<br>- 조회수는 동일 사용자 1시간 내 중복 카운트 안 함 | **P0** |
| **FR-006** | 상품관리 | 재고관리 | 재고 수량 조정 | **입력**: 상품코드, 조정 유형(입고/출고/조정), 수량, 사유<br>**처리**: 재고 수량 증감, 재고 이력 기록(일시, 유형, 수량, 사유, 담당자)<br>**출력**: 조정 후 재고 수량, 재고 이력 ID | - 출고 시 재고 부족하면 에러 발생<br>- 재고 0 이하로 감소 불가<br>- 재고 조정은 정수 단위만 가능<br>- 대량 조정(100개 이상) 시 관리자 승인 필요 | **P0** |
| **FR-007** | 상품관리 | 상태관리 | 상품 상태 변경 | **입력**: 상품코드, 변경할 상태(임시저장/판매대기/판매중/판매중지/판매종료)<br>**처리**: 상태 변경, 상태 변경 이력 기록<br>**출력**: 변경 완료 메시지 | - 상태 전이 규칙:<br>  * 임시저장 → 판매대기<br>  * 판매대기 → 판매중<br>  * 판매중 ↔ 판매중지<br>  * 판매중지 → 판매종료<br>- '판매중'으로 변경 시 필수 정보 검증(상품명, 가격, 재고 > 0, 이미지 1장 이상) | **P1** |
| **FR-008** | 상품관리 | 카테고리관리 | 상품 카테고리 설정 | **입력**: 상품코드, 카테고리 ID(대/중/소 분류)<br>**처리**: 카테고리 매핑, 카테고리별 상품 수 자동 갱신<br>**출력**: 설정 완료 메시지 | - 카테고리는 3단계 계층 구조(대/중/소)<br>- 하나의 상품은 하나의 카테고리에만 속함<br>- 존재하지 않는 카테고리 ID 입력 시 에러<br>- 카테고리 변경 시 이전 카테고리 정보 이력 보관 | **P1** |
| **FR-009** | 상품관리 | 이미지관리 | 상품 이미지 업로드/삭제 | **입력**: 상품코드, 이미지 파일(업로드), 이미지 ID(삭제)<br>**처리**: 이미지 리사이징(썸네일 200x200, 중간 800x800, 원본), CDN 업로드, URL 생성<br>**출력**: 이미지 URL 목록 | - 이미지 형식: JPG, PNG, WebP<br>- 파일 크기: 각 5MB 이하<br>- 최대 10장까지 등록<br>- 대표 이미지 1장 필수<br>- 이미지 순서 변경 가능 | **P1** |
| **NFR-001** | 비기능요구사항 | 성능 | 응답 시간 | 상품 목록 조회: 500ms 이하<br>상품 상세 조회: 300ms 이하<br>상품 등록/수정: 1초 이하 | - 동시 사용자 1,000명 이상 지원<br>- 데이터베이스 인덱스 최적화 필수 | **P0** |
| **NFR-002** | 비기능요구사항 | 보안 | 권한 관리 | 상품 등록/수정: 판매자 또는 관리자<br>상품 삭제: 관리자만<br>상품 조회: 모든 사용자(단, '삭제됨' 상태는 관리자만) | - JWT 토큰 기반 인증<br>- RBAC(Role-Based Access Control) 적용 | **P0** |
| **NFR-003** | 비기능요구사항 | 가용성 | 서비스 가용성 | 99.9% 이상 가용성 보장 | - 데이터베이스 이중화<br>- 자동 장애 복구 | **P1** |

---

## 2. 핵심 예외 케이스(Edge Case) 10선

### 시스템 아키텍처 관점

1. **동시성 제어 실패**
   - **상황**: 두 명의 관리자가 동일한 상품의 재고를 동시에 수정
   - **위험**: 재고 수량 불일치, 데이터 정합성 깨짐
   - **대응**: 낙관적 락(Optimistic Lock) 또는 비관적 락(Pessimistic Lock) 적용, 버전 관리

2. **대용량 이미지 업로드 시 타임아웃**
   - **상황**: 10장의 5MB 이미지를 동시에 업로드할 때 네트워크 지연
   - **위험**: 요청 타임아웃, 일부 이미지만 업로드되어 불완전한 상태
   - **대응**: 청크 업로드(Chunked Upload), 비동기 처리, 재시도 로직

3. **CDN 장애 시 이미지 조회 불가**
   - **상황**: CDN 서비스 장애로 상품 이미지 로드 실패
   - **위험**: 상품 상세 페이지 깨짐, 사용자 경험 저하
   - **대응**: Fallback 이미지 제공, 원본 서버 직접 조회, 캐시 활용

### 데이터 정합성 관점

4. **재고 마이너스 발생**
   - **상황**: 동시 주문으로 재고가 음수로 감소
   - **위험**: 실제 재고보다 많은 주문 발생, 배송 불가
   - **대응**: 재고 감소 시 CHECK 제약조건, 트랜잭션 격리 수준 상향(SERIALIZABLE)

5. **가격 변경 중 주문 발생**
   - **상황**: 관리자가 가격을 10,000원에서 5,000원으로 변경하는 순간 주문 발생
   - **위험**: 어떤 가격으로 주문되었는지 불명확
   - **대응**: 주문 시점의 가격을 주문 테이블에 스냅샷으로 저장, 가격 변경 이력 관리

6. **삭제된 상품에 대한 참조**
   - **상황**: 상품 삭제 후에도 장바구니, 위시리스트에 해당 상품 ID가 남아있음
   - **위험**: 조회 시 404 에러, 사용자 혼란
   - **대응**: 논리 삭제(Soft Delete) 사용, 외래키 제약조건, 정기적인 데이터 정리 배치

### 사용자 비정상 흐름 관점

7. **필수 정보 누락 상태에서 '판매중' 전환 시도**
   - **상황**: 이미지가 없는 상품을 '판매중'으로 변경 시도
   - **위험**: 불완전한 상품 정보로 판매, 고객 불만
   - **대응**: 상태 전환 전 필수 정보 검증 로직, 명확한 에러 메시지

8. **비정상적인 가격 입력**
   - **상황**: 가격에 0원, 음수, 또는 1억 원 이상의 비정상적인 값 입력
   - **위험**: 시스템 오류, 부정 거래
   - **대응**: 입력 검증(0 < 가격 ≤ 10,000,000원), 급격한 가격 변동 시 알림

9. **대량 상품 등록 시 메모리 부족**
   - **상황**: 엑셀 파일로 10,000개 상품을 한 번에 등록
   - **위험**: 메모리 부족(OOM), 서버 다운
   - **대응**: 배치 처리(1,000건 단위), 비동기 작업 큐, 진행 상태 표시

10. **권한 없는 사용자의 상품 수정 시도**
    - **상황**: 일반 사용자가 API를 직접 호출하여 다른 판매자의 상품 수정 시도
    - **위험**: 보안 취약점, 데이터 무결성 침해
    - **대응**: 모든 API에 권한 검증 미들웨어, 요청자와 상품 소유자 일치 확인

---

## 3. 리스크 기반 테스트 케이스(TC) 시나리오

| TC ID | 검증 시나리오 | 테스트 입력값/액션 | 기대 결과 | 중요도 |
|---|---|---|---|---|
| **TC-001** | 정상적인 상품 등록 | 상품명: "노트북", 가격: 1,500,000원, 재고: 10개, 이미지: 3장 | 상품코드 생성(PRD-20260206-0001), 상태: '임시저장', 등록 성공 메시지 | **High** |
| **TC-002** | 필수 정보 누락 시 등록 실패 | 상품명: "노트북", 가격: 누락, 재고: 10개 | 에러 메시지: "가격은 필수 입력 항목입니다", HTTP 400 | **High** |
| **TC-003** | 가격 100원 단위 절사 검증 | 가격: 1,500,550원 입력 | 실제 저장 가격: 1,500,500원 (50원 절사) | **Medium** |
| **TC-004** | 이미지 용량 초과 시 업로드 실패 | 6MB 이미지 파일 업로드 | 에러 메시지: "이미지 크기는 5MB 이하여야 합니다", HTTP 413 | **High** |
| **TC-005** | 동시 재고 감소 시 정합성 검증 | 재고 10개 상품에 대해 동시에 5개씩 2번 출고 요청 | 첫 번째 요청 성공(재고 5개), 두 번째 요청 실패(재고 부족 에러) | **Critical** |
| **TC-006** | 판매중 상품 가격 10% 이상 변경 제한 | 현재 가격 100,000원 상품을 50,000원으로 변경 시도 | 에러 메시지: "판매중 상품은 10% 이상 가격 변경이 불가합니다", HTTP 400 | **High** |
| **TC-007** | 주문 이력 있는 상품 삭제 시도 | 주문 이력이 있는 상품 삭제 요청 | 에러 메시지: "주문 이력이 있는 상품은 삭제할 수 없습니다", HTTP 409 | **High** |
| **TC-008** | 상태 전이 규칙 위반 검증 | '임시저장' 상태 상품을 바로 '판매중'으로 변경 시도 | 에러 메시지: "임시저장 상태에서 판매중으로 직접 전환할 수 없습니다", HTTP 400 | **Medium** |
| **TC-009** | 권한 없는 사용자의 상품 수정 시도 | 판매자 A의 상품을 판매자 B가 수정 시도 | 에러 메시지: "해당 상품을 수정할 권한이 없습니다", HTTP 403 | **Critical** |
| **TC-010** | 대량 상품 조회 시 페이징 검증 | 1,500개 상품 중 페이지 크기 20, 페이지 번호 2 요청 | 21~40번째 상품 반환, 총 건수: 1,500, 총 페이지: 75 | **Medium** |
| **TC-011** | 존재하지 않는 상품 조회 | 상품코드: "PRD-99999999-9999" 조회 | 에러 메시지: "상품을 찾을 수 없습니다", HTTP 404 | **Medium** |
| **TC-012** | 카테고리 변경 시 이력 보관 검증 | 상품 카테고리를 '전자제품 > 노트북'에서 '컴퓨터 > 노트북'으로 변경 | 카테고리 변경 성공, 이력 테이블에 변경 전 카테고리 정보 저장 확인 | **Medium** |
| **TC-013** | CDN 장애 시 Fallback 이미지 제공 | CDN URL 접근 불가 상황에서 상품 이미지 조회 | Fallback 이미지 URL 반환 또는 원본 서버 URL 반환 | **High** |
| **TC-014** | 재고 0인 상품 출고 시도 | 재고 0개 상품에 대해 1개 출고 요청 | 에러 메시지: "재고가 부족합니다", HTTP 409 | **High** |
| **TC-015** | 상품 목록 조회 응답 시간 검증 | 1,000개 상품 목록 조회 (필터 없음) | 응답 시간 500ms 이하, 상품 목록 정상 반환 | **High** |
| **TC-016** | 이미지 순서 변경 검증 | 이미지 순서를 [1,2,3]에서 [3,1,2]로 변경 | 이미지 순서 변경 성공, 조회 시 새로운 순서로 반환 | **Low** |
| **TC-017** | 삭제된 상품 일반 사용자 조회 시도 | '삭제됨' 상태 상품을 일반 사용자 권한으로 조회 | 에러 메시지: "상품을 찾을 수 없습니다", HTTP 404 | **Medium** |
| **TC-018** | 삭제된 상품 관리자 조회 | '삭제됨' 상태 상품을 관리자 권한으로 조회 | 상품 정보 정상 반환, 상태: '삭제됨' 표시 | **Medium** |
| **TC-019** | 대량 재고 조정 시 승인 프로세스 | 재고 150개 증가 요청 | 대기 상태로 전환, 관리자 승인 대기 메시지 반환 | **Medium** |
| **TC-020** | 동일 사용자 1시간 내 중복 조회수 카운트 방지 | 동일 사용자가 10분 간격으로 동일 상품 2번 조회 | 조회수 1만 증가 (중복 카운트 안 함) | **Low** |

---

## 4. 용어 정의서

| 용어 | 영문 | 정의 | 비고 |
|---|---|---|---|
| 상품코드 | Product Code | 상품을 고유하게 식별하는 코드 (형식: PRD-YYYYMMDD-NNNN) | 자동 생성 |
| 재고 | Stock/Inventory | 판매 가능한 상품의 수량 | 정수, 0 이상 |
| 논리 삭제 | Soft Delete | 데이터를 물리적으로 삭제하지 않고 상태만 변경 | 복구 가능 |
| 물리 삭제 | Hard Delete | 데이터베이스에서 실제로 레코드를 삭제 | 복구 불가 |
| 상태 전이 | State Transition | 상품의 상태가 한 단계에서 다른 단계로 변경되는 것 | 규칙 준수 필요 |
| 대표 이미지 | Thumbnail Image | 상품 목록에서 표시되는 주요 이미지 | 필수 1장 |
| CDN | Content Delivery Network | 이미지 등 정적 콘텐츠를 빠르게 제공하는 네트워크 | 성능 최적화 |
| 낙관적 락 | Optimistic Lock | 충돌이 드물다고 가정하고 버전으로 동시성 제어 | JPA @Version |
| 비관적 락 | Pessimistic Lock | 충돌이 빈번하다고 가정하고 레코드를 잠금 | SELECT FOR UPDATE |
| RBAC | Role-Based Access Control | 역할 기반 접근 제어 | 권한 관리 방식 |

---

## 5. 제약사항 및 가정사항

### 제약사항
1. 데이터베이스는 PostgreSQL 15 사용
2. 이미지 저장소는 AWS S3 또는 호환 스토리지 사용
3. API는 RESTful 방식으로 설계
4. 인증은 JWT 토큰 기반
5. 프론트엔드는 Next.js 15 사용

### 가정사항
1. 상품 카테고리는 사전에 정의되어 있음
2. 사용자 인증 시스템은 이미 구축되어 있음
3. 결제 시스템은 별도 모듈로 분리되어 있음
4. 초기 상품 데이터는 1,000개 이하
5. 월간 활성 사용자(MAU)는 10,000명 이하

---

**다음 단계**: 분석 Agent에게 인계하여 인터페이스 정의서 작성
